<!DOCTYPE html><html>

<head>
<meta charset="utf-8">
<title>Hadoop Cluster Install</title>
<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}
* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>
</head>
<body>
<pre><code>注意事項：
    1. 所有指令皆使用 root 身份執行，僅供練習使用。
    2. 前置步驟在 master, slaver1, slaver2 都必須做一遍。
    3. PDF 格式部分文字會失真，輸入時請注意符號是否正確。</code></pre>

<h1 id="toc_0">Hadoop + HBase + Hive 建置手冊（完全分布式）</h1>

<h2 id="toc_1">目錄</h2>

<ul>
<li>
<a href="#toc_0">Hadoop + HBase + Hive 建置手冊（完全分布式）</a>
<ul>
<li>
<a href="#toc_1">目錄</a>
</li>
<li>
<a href="#toc_2">套件清單</a>
</li>
<li>
<a href="#toc_3">環境配置</a>
</li>
<li>
<a href="#toc_4">前置步驟</a>
<ul>
<li>
<a href="#toc_5">安裝 JDK</a>
</li>
<li>
<a href="#toc_6">編輯 profile</a>
</li>
<li>
<a href="#toc_7">載入 profile</a>
</li>
<li>
<a href="#toc_8">產生 SSH key</a>
</li>
<li>
<a href="#toc_9">SSH asking disable</a>
</li>
<li>
<a href="#toc_10">重新啟動 SSH</a>
</li>
<li>
<a href="#toc_11">Security disable</a>
</li>
<li>
<a href="#toc_12">Permanent disable</a>
</li>
<li>
<a href="#toc_13">關閉防火牆</a>
</li>
<li>
<a href="#toc_14">開機不啟動防火牆</a>
</li>
</ul>
</li>
<li>
<a href="#toc_15">Apache Hadoop</a>
<ul>
<li>
<a href="#toc_16">安裝 Apache Hadoop</a>
<ul>
<li>
<a href="#toc_17">解壓縮並建立連結</a>
</li>
<li>
<a href="#toc_18">建立 Hadoop 暫存目錄</a>
</li>
<li>
<a href="#toc_19">編輯 hosts</a>
</li>
<li>
<a href="#toc_20">編輯 profile</a>
</li>
<li>
<a href="#toc_21">載入 profile</a>
</li>
<li>
<a href="#toc_22">編輯 slaves</a>
</li>
<li>
<a href="#toc_23">編輯 core-site.xml</a>
</li>
<li>
<a href="#toc_24">編輯 hdfs-site.xml</a>
</li>
<li>
<a href="#toc_25">編輯 mapred-site.xml</a>
</li>
<li>
<a href="#toc_26">編輯 yarn-site.xml</a>
</li>
<li>
<a href="#toc_27">編輯 hadoop-env.sh</a>
</li>
<li>
<a href="#toc_28">Copy to slavers</a>
</li>
<li>
<a href="#toc_29">Hadoop format</a>
</li>
<li>
<a href="#toc_30">Reboot all hosts</a>
</li>
</ul>
</li>
<li>
<a href="#toc_31">啟動 Apache Hadoop</a>
</li>
<li>
<a href="#toc_32">測試</a>
</li>
</ul>
</li>
<li>
<a href="#toc_33">Zookeeper</a>
<ul>
<li>
<a href="#toc_34">安裝 ZooKeeper</a>
<ul>
<li>
<a href="#toc_35">解壓縮並建立連結</a>
</li>
<li>
<a href="#toc_36">編輯 profile</a>
</li>
<li>
<a href="#toc_37">載入 profile</a>
</li>
<li>
<a href="#toc_38">編輯 zoo.cfg</a>
</li>
<li>
<a href="#toc_39">編輯 myid</a>
</li>
</ul>
</li>
<li>
<a href="#toc_40">啟動 ZooKeeper</a>
</li>
</ul>
</li>
<li>
<a href="#toc_41">Apache HBase</a>
<ul>
<li>
<a href="#toc_42">安裝 HBase</a>
<ul>
<li>
<a href="#toc_43">解壓縮並建立連結</a>
</li>
<li>
<a href="#toc_44">編輯 profile</a>
</li>
<li>
<a href="#toc_45">載入 profile</a>
</li>
<li>
<a href="#toc_46">編輯 regionservers</a>
</li>
<li>
<a href="#toc_47">編輯 hbase-env.sh</a>
</li>
<li>
<a href="#toc_48">編輯 hbase-site.xml</a>
</li>
<li>
<a href="#toc_49">Remove hbase&#39;s log4j (bug)</a>
</li>
<li>
<a href="#toc_50">Copy to slavers</a>
</li>
</ul>
</li>
<li>
<a href="#toc_51">啟動 HBase</a>
</li>
</ul>
</li>
<li>
<a href="#toc_52">Apache Hive</a>
<ul>
<li>
<a href="#toc_53">安裝 Hive</a>
<ul>
<li>
<a href="#toc_54">解壓縮並建立連結</a>
</li>
<li>
<a href="#toc_55">編輯 profile</a>
</li>
<li>
<a href="#toc_56">載入 profile</a>
</li>
<li>
<a href="#toc_57">HDFS 上建立資料夾</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


<h2 id="toc_2">套件清單</h2>

<table>
<thead>
<tr>
<th style="text-align: left">Package</th>
<th style="text-align: left">Package Name</th>
<th style="text-align: left">Installation Path</th>
<th style="text-align: center">Version</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">Oracle Java</td>
<td style="text-align: left">jdk-7u79-linux-x64.rpm</td>
<td style="text-align: left">/user/java/java</td>
<td style="text-align: center">7</td>
</tr>
<tr>
<td style="text-align: left">Apache Hadoop</td>
<td style="text-align: left">hadoop-2.4.1.tar.gz</td>
<td style="text-align: left">/opt/hadoop</td>
<td style="text-align: center">2.4.1</td>
</tr>
<tr>
<td style="text-align: left">Apache HBase</td>
<td style="text-align: left">hbase-0.98.13-hadoop2-bin.tar.gz</td>
<td style="text-align: left">/opt/hbase</td>
<td style="text-align: center">0.98.13</td>
</tr>
<tr>
<td style="text-align: left">Apache Hive</td>
<td style="text-align: left">apache-hive-1.0.1-bin.tar.gz</td>
<td style="text-align: left">/opt/hive</td>
<td style="text-align: center">1.0.1</td>
</tr>
<tr>
<td style="text-align: left">Apache Zookeeper</td>
<td style="text-align: left">zookeeper-3.4.6.tar.gz</td>
<td style="text-align: left">/opt/zookeeper</td>
<td style="text-align: center">3.4.6</td>
</tr>
</tbody>
</table>

<p><a href="#toc_0">TOP</a></p>

<h2 id="toc_3">環境配置</h2>

<table>
<thead>
<tr>
<th style="text-align: center">OS</th>
<th style="text-align: center">IP</th>
<th style="text-align: center">Host Name</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: center">CentOS 6.7</td>
<td style="text-align: center">192.168.60.100</td>
<td style="text-align: center">master</td>
</tr>
<tr>
<td style="text-align: center">CentOS 6.7</td>
<td style="text-align: center">192.168.60.101</td>
<td style="text-align: center">slaver1</td>
</tr>
<tr>
<td style="text-align: center">CentOS 6.7</td>
<td style="text-align: center">192.168.60.102</td>
<td style="text-align: center">slaver2</td>
</tr>
</tbody>
</table>

<p><a href="#toc_0">TOP</a></p>

<h2 id="toc_4">前置步驟</h2>

<h3 id="toc_5">安裝 JDK</h3>

<pre><code>$ rpm -ivh /tmp/jdk-7u79-linux-x64.rpm
$ ln -s /usr/java/jdk1.7.0_79 /usr/java/java</code></pre>

<h3 id="toc_6">編輯 profile</h3>

<pre><code>$ vim /etc/profile</code></pre>

<blockquote>
<p>增加內容</p>

<pre><code>export JAVA_HOME=/usr/java/java
export JRE_HOME=$JAVA_HOME/jre
export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib/rt.jar
export PATH=$PATH:$JAVA_HOME/bin</code></pre>
</blockquote>

<h3 id="toc_7">載入 profile</h3>

<pre><code>$ source /etc/profile</code></pre>

<h3 id="toc_8">產生 SSH key</h3>

<pre><code>$ ssh-keygen -t rsa -f ~/.ssh/id_rsa -P &quot;&quot;
$ cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
$ ssh localhost exit</code></pre>

<h3 id="toc_9">SSH asking disable</h3>

<pre><code>$ vim /etc/ssh/ssh_config</code></pre>

<blockquote>
<p>修改內容</p>

<pre><code>StrictHostKeyChecking no</code></pre>
</blockquote>

<h3 id="toc_10">重新啟動 SSH</h3>

<pre><code>$ service sshd restart</code></pre>

<h3 id="toc_11">Security disable</h3>

<pre><code>$ setenforce 0</code></pre>

<h3 id="toc_12">Permanent disable</h3>

<pre><code>$ vim /etc/selinux/config</code></pre>

<blockquote>
<p>修改內容</p>

<pre><code>SELINUX=disabled</code></pre>
</blockquote>

<h3 id="toc_13">關閉防火牆</h3>

<pre><code>$ service iptables stop</code></pre>

<h3 id="toc_14">開機不啟動防火牆</h3>

<pre><code>$ chkconfig iptables off</code></pre>

<p><a href="#toc_0">TOP</a></p>

<h2 id="toc_15">Apache Hadoop</h2>

<h3 id="toc_16">安裝 Apache Hadoop</h3>

<h4 id="toc_17">解壓縮並建立連結</h4>

<pre><code>$ tar -zxvf /tmp/hadoop-2.4.1.tar.gz
$ mv hadoop-2.4.1 /opt
$ ln -s /opt/hadoop-2.4.1 /opt/hadoop</code></pre>

<h4 id="toc_18">建立 Hadoop 暫存目錄</h4>

<pre><code>$ mkdir -p /opt/hadoop/tmp</code></pre>

<h4 id="toc_19">編輯 hosts</h4>

<pre><code>$ vim /etc/hosts</code></pre>

<blockquote>
<p>增加內容</p>

<pre><code>192.168.60.100 master 
192.168.60.101 slaver1 
192.168.60.102 slaver2</code></pre>
</blockquote>

<h4 id="toc_20">編輯 profile</h4>

<pre><code>$ vim /etc/profile</code></pre>

<blockquote>
<p>增加內容</p>

<pre><code>export HADOOP_HOME=/opt/hadoop/
export HADOOP_MAPRED_HOME=$HADOOP_HOME
export HADOOP_COMMON_HOME=$HADOOP_HOME
export HADOOP_HDFS_HOME=$HADOOP_HOME
export YARN_HOME=$HADOOP_HOME
export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop
export YARN_CONF_DIR=$HADOOP_HOME/etc/hadoop
export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin
export HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native
export HADOOP_OPTS=&quot;-Djava.library.path=$HADOOP_HOME/lib&quot;</code></pre>
</blockquote>

<h4 id="toc_21">載入 profile</h4>

<pre><code>$ source /etc/profile</code></pre>

<h4 id="toc_22">編輯 slaves</h4>

<pre><code>$ vim $HADOOP_HOME/etc/hadoop/slaves</code></pre>

<blockquote>
<p>覆蓋內容</p>

<pre><code>slaver1
slaver2</code></pre>
</blockquote>

<h4 id="toc_23">編輯 core-site.xml</h4>

<pre><code>$ vim $HADOOP_HOME/etc/hadoop/core-site.xml</code></pre>

<blockquote>
<p>覆蓋內容</p>

<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration&gt;
   &lt;property&gt;
      &lt;name&gt;fs.defaultFS&lt;/name&gt;
      &lt;value&gt;hdfs://master:9000&lt;/value&gt;
   &lt;/property&gt;
   &lt;property&gt;
      &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
      &lt;value&gt;/opt/hadoop/tmp&lt;/value&gt;
   &lt;/property&gt;
&lt;/configuration&gt;</code></pre>
</blockquote>

<h4 id="toc_24">編輯 hdfs-site.xml</h4>

<pre><code>$ vim $HADOOP_HOME/etc/hadoop/hdfs-site.xml</code></pre>

<blockquote>
<p>覆蓋內容</p>

<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration&gt;
   &lt;property&gt;
      &lt;name&gt;dfs.replication&lt;/name&gt;
      &lt;value&gt;1&lt;/value&gt;
   &lt;/property&gt;
   &lt;property&gt;
      &lt;name&gt;dfs.permissions&lt;/name&gt;
      &lt;value&gt;false&lt;/value&gt;
   &lt;/property&gt;
&lt;/configuration&gt;</code></pre>
</blockquote>

<h4 id="toc_25">編輯 mapred-site.xml</h4>

<pre><code>$ vim $HADOOP_HOME/etc/hadoop/mapred-site.xml</code></pre>

<blockquote>
<p>覆蓋內容</p>

<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration&gt;
   &lt;property&gt;
      &lt;name&gt;mapreduce.framework.name&lt;/name&gt;
      &lt;value&gt;yarn&lt;/value&gt;
   &lt;/property&gt;
&lt;/configuration&gt;</code></pre>
</blockquote>

<h4 id="toc_26">編輯 yarn-site.xml</h4>

<pre><code>$ vim $HADOOP_HOME/etc/hadoop/yarn-site.xml</code></pre>

<blockquote>
<p>覆蓋內容</p>

<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration&gt;
   &lt;property&gt;
      &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;
      &lt;value&gt;master&lt;/value&gt;
   &lt;/property&gt;
   &lt;property&gt;
      &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
      &lt;value&gt;mapreduce_shuffle&lt;/value&gt;
   &lt;/property&gt;
   &lt;property&gt;
      &lt;name&gt;yarn.nodemanager.aux-services.mapreduce.shuffle.class&lt;/name&gt;
      &lt;value&gt;org.apache.hadoop.mapred.ShuffleHandler&lt;/value&gt;
   &lt;/property&gt;
&lt;/configuration&gt;</code></pre>
</blockquote>

<h4 id="toc_27">編輯 hadoop-env.sh</h4>

<pre><code>$ vim $HADOOP_HOME/etc/hadoop/hadoop-env.sh</code></pre>

<blockquote>
<p>修改內容</p>

<pre><code>export JAVA_HOME=/usr/java/java</code></pre>
</blockquote>

<h4 id="toc_28">Copy to slavers</h4>

<pre><code>$ scp -rp /opt/hadoop slaver1:/opt
$ scp -rp /opt/hadoop slaver2:/opt
$ scp –rp /etc/hosts slaver1:/etc
$ scp –rp /etc/hosts slaver2:/etc
$ scp -rp /etc/profile root@slaver1:/etc
$ scp -rp /etc/profile root@slaver2:/etc</code></pre>

<h4 id="toc_29">Hadoop format</h4>

<pre><code>$ hadoop namenode -format</code></pre>

<h4 id="toc_30">Reboot all hosts</h4>

<pre><code>$ ssh slaver1 reboot
$ ssh slaver2 reboot
$ reboot</code></pre>

<h3 id="toc_31">啟動 Apache Hadoop</h3>

<pre><code>$ start-dfs.sh
$ start-yarn.sh</code></pre>

<h3 id="toc_32">測試</h3>

<pre><code>$ hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-*-tests.jar TestDFSIO -write
$ hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-*-tests.jar TestDFSIO -clean
$ hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-examples-*.jar pi 2 5</code></pre>

<p><a href="#toc_0">TOP</a></p>

<h2 id="toc_33">Zookeeper</h2>

<h3 id="toc_34">安裝 ZooKeeper</h3>

<h4 id="toc_35">解壓縮並建立連結</h4>

<pre><code>$ tar -zxvf /tmp/zookeeper-3.4.6.tar.gz
$ mv zookeeper-3.4.6 /opt
$ ln -s /opt/zookeeper-3.4.6 /opt/zookeeper</code></pre>

<h4 id="toc_36">編輯 profile</h4>

<pre><code>$ vim /etc/profile</code></pre>

<blockquote>
<p>增加內容</p>

<pre><code>export ZOOKEEPER_HOME=/opt/zookeeper
export PATH=$PATH:$ZOOKEEPER_HOME/bin</code></pre>
</blockquote>

<h4 id="toc_37">載入 profile</h4>

<pre><code>$ source /etc/profile</code></pre>

<h4 id="toc_38">編輯 zoo.cfg</h4>

<pre><code>$ cp $ZOOKEEPER_HOME/conf/zoo_sample.cfg $ZOOKEEPER_HOME/conf/zoo.cfg
$ vim $ZOOKEEPER_HOME/conf/zoo.cfg</code></pre>

<blockquote>
<p>增修內容</p>

<pre><code>dataDir=/opt/zookeeper
server.1=master:2888:3888</code></pre>
</blockquote>

<h4 id="toc_39">編輯 myid</h4>

<pre><code>$ vim /opt/zookeeper/myid</code></pre>

<blockquote>
<p>覆蓋內容</p>

<pre><code>1</code></pre>
</blockquote>

<h3 id="toc_40">啟動 ZooKeeper</h3>

<pre><code>zkServer.sh start</code></pre>

<p><a href="#toc_0">TOP</a></p>

<h2 id="toc_41">Apache HBase</h2>

<h3 id="toc_42">安裝 HBase</h3>

<h4 id="toc_43">解壓縮並建立連結</h4>

<pre><code>$ tar -zxvf /tmp/hbase-0.98.13-hadoop2-bin.tar.gz
$ mv hbase-0.98.13-hadoop2 /opt
$ ln -s /opt/hbase-0.98.13-hadoop2 /opt/hbase</code></pre>

<h4 id="toc_44">編輯 profile</h4>

<pre><code>$ vim /etc/profile</code></pre>

<blockquote>
<p>增加內容</p>

<pre><code>export HBASE_HOME=/opt/hbase
export PATH=$PATH:$HBASE_HOME/bin</code></pre>
</blockquote>

<h4 id="toc_45">載入 profile</h4>

<pre><code>$ source /etc/profile</code></pre>

<h4 id="toc_46">編輯 regionservers</h4>

<pre><code>$ vim $HBASE_HOME/conf/regionservers</code></pre>

<blockquote>
<p>增加內容</p>

<pre><code>slaver1
slaver2</code></pre>
</blockquote>

<h4 id="toc_47">編輯 hbase-env.sh</h4>

<pre><code>$ vim $HBASE_HOME/conf/hbase-env.sh</code></pre>

<blockquote>
<p>增加內容</p>

<pre><code>export JAVA_HOME=/usr/java/java
export HBASE_MANAGES_ZK=false</code></pre>
</blockquote>

<h4 id="toc_48">編輯 hbase-site.xml</h4>

<pre><code>$ vim $HBASE_HOME/conf/hbase-site.xml</code></pre>

<blockquote>
<p>覆蓋內容</p>

<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration&gt;
   &lt;property&gt;
      &lt;name&gt;hbase.rootdir&lt;/name&gt;
      &lt;value&gt;hdfs://master:9000/hbase&lt;/value&gt;
   &lt;/property&gt;
   &lt;property&gt;
      &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;
      &lt;value&gt;true&lt;/value&gt;
   &lt;/property&gt;
   &lt;property&gt;
      &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;
      &lt;value&gt;master&lt;/value&gt;
   &lt;/property&gt;
   &lt;property&gt;
      &lt;name&gt;hbase.zookeeper.property.dataDir&lt;/name&gt;
      &lt;value&gt;/opt/zookeeper&lt;/value&gt;
   &lt;/property&gt;
&lt;/configuration&gt;</code></pre>
</blockquote>

<h4 id="toc_49">Remove hbase&#39;s log4j (bug)</h4>

<pre><code>rm -rf $HBASE_HOME/lib/slf4j-log4j12-1.6.4.jar</code></pre>

<h4 id="toc_50">Copy to slavers</h4>

<pre><code>$ scp -rp /opt/hbase root@slaver1:/opt
$ scp -rp /opt/hbase root@slaver2:/opt
$ scp -rp /etc/profile root@slaver1:/etc
$ scp -rp /etc/profile root@slaver2:/etc</code></pre>

<h3 id="toc_51">啟動 HBase</h3>

<pre><code>$ start-hbase.sh</code></pre>

<p><a href="#toc_0">TOP</a></p>

<h2 id="toc_52">Apache Hive</h2>

<h3 id="toc_53">安裝 Hive</h3>

<h4 id="toc_54">解壓縮並建立連結</h4>

<pre><code>$ tar -zxvf /tmp/apache-hive-1.0.1-bin.tar.gz
$ mv apache-hive-1.0.1-bin /opt
$ ln -s /opt/apache-hive-1.0.1-bin /opt/hive</code></pre>

<h4 id="toc_55">編輯 profile</h4>

<pre><code>$ vim /etc/profile</code></pre>

<blockquote>
<p>增加內容</p>

<pre><code>export HIVE_HOME=/opt/hive
export PATH=$PATH:$HIVE_HOME/bin</code></pre>
</blockquote>

<h4 id="toc_56">載入 profile</h4>

<pre><code>$ source /etc/profile</code></pre>

<h4 id="toc_57">HDFS 上建立資料夾</h4>

<pre><code>$ hadoop fs -mkdir /tmp
$ hadoop fs -mkdir -p /user/hive/warehouse
$ hadoop fs -chmod g+w /tmp
$ hadoop fs -chmod g+w /user/hive/warehouse</code></pre>

<p><a href="#toc_0">TOP</a></p>


</body>

</html>
